<?xml version="1.0" encoding="utf-8"?>
<!--
    # This comment is generated by WixEdit, the specific commandline
    # arguments for the WiX Toolset are stored here.

    candleArgs: "<projectfile>" -out "<projectname>.wixobj" <extensions> -dVersion=1.0.0.0 -dProjectDir=.\..\..\bin\release
    lightArgs: "<projectname>.wixobj" -out "<projectname>.msi" <extensions> -cultures:ru-ru
-->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <Product Id="344FFFFA-CF75-4A5D-9018-54FA1F6A3E61" Language="1033" Manufacturer="Trustbox" Name="Rabnet" Version="$(var.Version)" UpgradeCode="8F4BB748-14F8-47B7-8F35-C567F0A1B29A">
        <Package Description="Rabnet" InstallerVersion="300" Compressed="yes" />
        <Media Id="1" Cabinet="rabnet.cab" EmbedCab="yes" />
        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="ProgramFilesFolder" Name="PFiles">
                <Directory Id="RabbitsDir" Name="RabNet">
                    <Component Id="MainProgram" Guid="3D19CA32-71E7-4A06-B323-142F4C03DB42">
                        <File Id="rabnet.exe" Source="$(var.ProjectDir)\rabnet.exe" Checksum="yes" KeyPath="yes" />
                        <File Id="mia_conv.exe" Source="$(var.ProjectDir)\mia_conv.exe" Checksum="yes" />
                        <File Id="db.mysql.dll" Source="$(var.ProjectDir)\db.mysql.dll" Checksum="yes" />
                        <File Id="engine.dll" Source="$(var.ProjectDir)\engine.dll" Checksum="yes" />
                        <File Id="log4net.dll" Source="$(var.ProjectDir)\log4net.dll" Checksum="yes" />
                        <File Id="Mysql.Data.dll" Source="$(var.ProjectDir)\Mysql.Data.dll" Checksum="yes" />
                        <File Id="RdlEngine.dll" Source="$(var.ProjectDir)\RdlEngine.dll" Checksum="yes" />
                        <File Id="RdlViewer.dll" Source="$(var.ProjectDir)\RdlViewer.dll" Checksum="yes" />
                    </Component>
                    <Directory Id="ReportsDir" Name="reports">
                        <Component Id="Reports" Guid="AF1369D3-6231-4FE8-8884-7ECDA59DE059">
                            <File Id="age.rdl" Source="$(var.ProjectDir)\reports\age.rdl" Checksum="yes" />
                            <File Id="breeds.rdl" Source="$(var.ProjectDir)\reports\breeds.rdl" Checksum="yes" />
                            <File Id="dead.rdl" Source="$(var.ProjectDir)\reports\dead.rdl" Checksum="yes" />
                            <File Id="deadreason.rdl" Source="$(var.ProjectDir)\reports\deadreason.rdl" Checksum="yes" />
                            <File Id="fucker.rdl" Source="$(var.ProjectDir)\reports\fucker.rdl" Checksum="yes" />
                            <File Id="rabbit.rdl" Source="$(var.ProjectDir)\reports\rabbit.rdl" Checksum="yes" KeyPath="yes" />
                            <File Id="realization.rdl" Source="$(var.ProjectDir)\reports\realization.rdl" Checksum="yes" />
                            <File Id="zooteh.rdl" Source="$(var.ProjectDir)\reports\zooteh.rdl" Checksum="yes" />
                            <File Id="zooteh_nofuck.rdl" Source="$(var.ProjectDir)\reports\zooteh_nofuck.rdl" Checksum="yes" />
                        </Component>
                    </Directory>
                </Directory>
            </Directory>
            <Directory Id="ProgramMenuFolder" Name="ProgramsMenu">
                <Directory Id="MenuDir" Name="Миакро">
                    <Component Id="MenuShortcuts" Guid="507B20FA-2868-4241-94D3-D8EDE75EAC9F">
                        <Shortcut Id="rabnetShortcut" Name="Миакро rabnet" WorkingDirectory="RabbitsDir" Target="[RabbitsDir]rabnet.exe" />
                        <Shortcut Id="miaconvShortcut" Name="Импорт фермы" WorkingDirectory="RabbitsDir" Target="[RabbitsDir]mia_conv.exe" />
                        <Shortcut Id="UninstallShortcut" Name="Удалить" Target="[System64Folder]msiexec.exe" Arguments="/x [ProductCode]" />
                        <RemoveFolder Id="MenuDir" On="uninstall" />
                        <RegistryValue Root="HKCU" Key="Software\TrustBox\RabNet" Name="installed" Type="integer" Value="1" KeyPath="yes" />
                    </Component>
                </Directory>
            </Directory>
            <Directory Id="DesktopFolder">
                <Component Id="DesktopShortcuts" Guid="D7CA67CD-9F2B-43D6-B98A-C907BD09CE3D">
                    <Shortcut Id="rabnetDesktopShortcut" Name="Миакро rabnet" WorkingDirectory="RabbitsDir" Target="[RabbitsDir]rabnet.exe" />
                    <RegistryValue Root="HKCU" Key="Software\TrustBox\RabNet" Name="desktop" Type="integer" Value="1" KeyPath="yes" />
                </Component>
            </Directory>
        </Directory>
        <Feature Id="FullSetup" Level="1" Title="FullInstall">
            <ComponentRef Id="MainProgram" />
            <ComponentRef Id="Reports" />
            <ComponentRef Id="MenuShortcuts" />
            <ComponentRef Id="DesktopShortcuts" />
        </Feature>
        <UIRef Id="WixUI_Minimal" />
        <UI />
    </Product>
</Wix>